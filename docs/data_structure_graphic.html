<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="" />


<title>Report table structure</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Report data structures</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="reporting_data_structure.html">Part 1: Introduction</a>
</li>
<li>
  <a href="demog_data_structure.html">Part 2: Demographics</a>
</li>
<li>
  <a href="data_structure_graphic.html">Part 3: Defining common structure</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Report table structure</h1>

</div>


<div class="figure">
<img src="images/gt_parts_of_a_table.svg" alt="Figure taken from the gt package" width="100%" />
<p class="caption">
Figure taken from the gt package
</p>
</div>
<p>The above graphic explaining the api for the <a href="https://gt.rstudio.com/">gt package</a> provides a good initial basis to begin thinking about a data frame structure that can be mapped to a table report.</p>
<p>As a remainder from previous discussion the proposal would be to define a data structure in a long format with one observation per unique value presented in the table. What is denoted as a cell in the graphic may represent the concatanation of multiple original values (in the case the cell contains an estimate with associated confidence interval this would be 3 values).</p>
<p>For clinical report tables the stub of the table may require more than a single row label column. Maybe a maximum of three levels to cover tables where the summaries are displayed by time period, by paramater and by multiple statistics. Additionally, many tables are repeated across values of a by-group variable.</p>
<p>####Variables in the initial dataframe</p>
<p>WIP(maybe better to switch to more CDISC like nomenclature??)</p>
<ul>
<li><strong>subgroup</strong>(optional): partition the entire table by levels of this variable.</li>
<li><strong>column</strong> column headers for the table</li>
<li><strong>sub-column</strong>(optional): additional variable which if specfied would be nested under a spanning header of column values. I.e break down demographics table by Arm and sex.</li>
<li><strong>section</strong> horizontal sections of the table</li>
<li><strong>section_label</strong> (optional) denoted as ROW_GROUP_LABEL in the diagram. If missing could default to section value.</li>
<li><strong>row_n</strong>(optional?) unique idenitifer within column*section for controlling section level ordering.</li>
<li><strong>value</strong> single numeric value that may require concatentation with other values (n (%), confidence interval) to create the table cell contents.</li>
<li><strong>label</strong> (better row_label??) row label element of the table</li>
<li><strong>display</strong> a term which will drive (with a dictionary of display terms) the conversion of values to cells depending on the display rule.</li>
<li><strong>precision</strong> (ideally this would be incorporated into display somehow. Maybe displayN). Rounding precision applied when converting numeric values into character cell values.</li>
</ul>
<p>Additional information required for conversion of this dataframe into a table: <strong>display dictionary</strong>. <strong>row group label</strong>(see graphic) information.</p>
<div id="variables-in-the-intermediate-dataframe" class="section level4">
<h4>Variables in the intermediate dataframe</h4>
<ul>
<li><strong>subgroup</strong>(optional): partition the entire table by levels of this variable.</li>
<li><strong>column</strong> column headers for the table</li>
<li><strong>sub-column</strong>(optional): additional variable which if specfied would be nested under a spanning header of column values. I.e break down demographics table by Arm and sex.</li>
<li><strong>section</strong> horizontal sections of the table</li>
<li><strong>section_label</strong> (optional) denoted as ROW_GROUP_LABEL in the diagram. If missing could default to section value.</li>
<li><strong>row_n</strong>(optional?) unique idenitifer within column*section for controlling section level ordering.</li>
<li><strong>label</strong> row label element of the table</li>
<li><strong>cell</strong> single value that be need concatentation (n (%), confidence interval) to create the table cell content</li>
</ul>
</div>
<div id="limitations" class="section level4">
<h4>Limitations</h4>
<p>We have not considered table cells that require character values. For tables with a few character values this could be done in a CDISC like fashion by adding an optional <code>valuec</code> variable for reports that have this requirement though for tables comprising a lot of text this may still be insufficent. This mapping would not be useful for the creation of accompanying listings.</p>
</div>
<div id="extensions" class="section level3">
<h3>Extensions</h3>
<p>It may be desirable to add futher variables adding traceability of methods used to create the values in the standardized data frame. E.g. What statistical modelling was performed.</p>
<p>The advantage of having standardized data frame means that it should be possible to store this data and access it through some API to permit fast retrieval of values from tables. Depending on upstream storage and API design it may be interesting to further convert the dataframe to JSON structures. Although it may be sufficient to just load the data into SQL databases with associated metadata.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
